<html>
<head runat="server">
<title>Ingreso de Solicitud</title>
<meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	
	<!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport"/>
    <!-- Bootstrap 3.3.6 -->
    <link rel="stylesheet" href="css/bootstrap.min.css"/>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="fonts/font-awesome.min.css"/>
    <!-- jvectormap -->
    <link rel="stylesheet" href="plugins/jvectormap/jquery-jvectormap-1.2.2.css"/>
    <!-- Theme style -->
    <link rel="stylesheet" href="css/AdminLTE.min.css"/>
    <!-- AdminLTE Skins. Choose a skin from the css/skins
    folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="css/skins/_all-skins.min.css"/>
    <style type="text/css">.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}</style>
	
	
	<script type="text/javascript">
	
	
	function getQuerystring(key, default_) {
		if (default_ == null)
			default_ = "";
		key = key.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
		var regex = new RegExp("[\\?&amp;]"+key+"=([^&amp;#]*)");
		var qs = regex.exec(window.location.href);
		if(qs == null)
			return default_;
		else
			return qs[1];
	}

	function CerrarSesion() {
//window.location.reload();
        }
	</script>
	
	<script type="text/javascript" src="plugins/jQuery/jquery-2.2.3.min.js"></script>

</head>
<body class="skin-blue sidebar-mini">
    <div class="wrapper">
        <header class="main-header">
            <nav class="navbar navbar-static-top" style="height: 10px !important;">
              <!-- Sidebar toggle button-->
              <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">    
                  <!-- User Account: style can be found in dropdown.less -->
                  <li class="dropdown user user-menu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                      <span><i class="fa fa-user"></i></span>
                      <span style="padding-left:5px;" id="tagUsuario"></span>
                    </a>
                    <ul class="dropdown-menu">
                      <!-- User image -->
                      <li class="user-header">
                        <span><i class="fa fa-user" style ="font-size:90px;color:white"></i></span>
                        <p id="pUsuario">XXXXXXXX</p>
                      </li>
                      <!-- Menu Body -->
              
                      <!-- Menu Footer-->
                      <li class="user-footer">
                        <div class="pull-right">
                          <a onclick ="javascript:CerrarSesion();" class="btn btn-default btn-flat">Cerrar Sesión</a>
                        </div>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <a onclick="javascript:CerrarSesion();" data-toggle="control-sidebar"><i class="fa fa-power-off"></i></a>
                  </li>
                </ul>
              </div>
            </nav>
        </header>
		<div class="content-wrapper" style="min-height: 560px;">
            <section id="contenedorDetallePrincipal">
                <div class="content">
                    <div class="row">
					 <div class="col-xs-12">
						<div class="box box-primary">
							<div class="box-header with-border">
								<h3 class="box-title">Ingreso de Solicitud</h3>
							</div>
							<!-- /.box-header -->
							<div class="box-body">
							<form id="frmIngreso" name="frmIngreso" class="form-horizontal">
								<input type="hidden" id="hdnUsuario" name="hdnUsuario" value="" />
								<!--<div class="form-group">
									<label class="col-sm-2 control-label">Solicitud #:</label>
									<div class="col-sm-10">
										<input type="text" class="form-control" id="txtIdSolicitud" disabled="disabled" maxlength="5"/>
									</div>
								</div>-->
							
							<div class="form-group">
							  <label class="col-sm-2 control-label">Facultad</label>

							  <div id="dvFacultad" class="col-sm-10">						
								<select class="form-control" id="cmbFacultad" name="cmbFacultad" >
								<option value='0'>-- Escoja Facultad --</option>
								</select>
							  </div>
							</div>

							<div class="form-group">
							  <label class="col-sm-2 control-label">Dirigido a: </label>

								<div class="col-sm-10">
									<select class="form-control" id="cmbDirigido" name="cmbDirigido">
									</select>
									<script type="text/javascript">
										function cargar_dirigido(){
										
											var array=["-- Escoja Opción --","Decano(a) de la Facultad", "Director(a) de la Facultad"];
											for(var i in array)
											{
												document.getElementById("cmbDirigido").innerHTML += "<option value='" + i+"'>" + array[i]+ "</option>";
												//alert("<option value='" + i+"'>" + array[i]+ "</option>");
											}
										}
										cargar_dirigido();
									</script>
								</div>
							</div>

							<div class="form-group">
							  <label class="col-sm-2 control-label">Tipo de Solicitud: </label>

							  <div id="dvTipo" class="col-sm-10">						
								<select class="form-control" id="cmbTipoSolicitud" name="cmbTipoSolicitud">
								<option value='0'>-- Escoja Tipo --</option>
								</select>
							  </div>
								
							</div>
							
							<div class="form-group">
								<label for="inputPassword3" class="col-sm-2 control-label">Contenido de la solicitud</label>

							  <div class="col-sm-10">
								
								<textarea type="text" id="txtSolicitud" name="txtSolicitud" class="form-control md-textarea"></textarea>
							  </div>
							</div>
							</form>
							
							<div class="box-footer">
								
								<input type="button" onclick="javascript:Regresar();" class="btn btn-default" value="Regresar">
								
								<input type="button" onclick="javascript:RegistrarSolicitud();" class="btn btn-info pull-right" value="Registrar">
							</div>
							
						</div>
					 
					
					</div>
				</Div>
			</section>
		</div>
		

</body>
<!-- Bootstrap 3.3.6 -->
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <!-- FastClick -->
    <script type="text/javascript" src="plugins/fastclick/fastclick.js"></script>
    <!-- AdminLTE App -->
    <script type="text/javascript" src="js/app.min.js"></script>
    <!-- Sparkline -->
    <script type="text/javascript" src="plugins/sparkline/jquery.sparkline.min.js"></script>
    <!-- jvectormap -->
    <script type="text/javascript" src="plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
    <script type="text/javascript" src="plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
    
<script language="javascript">

var strUsuario = getQuerystring("usuario");
$("#tagUsuario").html(strUsuario);
$("#hdnUsuario").val(strUsuario);
//alert(strUsuario);

function ValidaCampos(){
	//var idsolicitud= document.getElementById('txtIdSolicitud').value;
	var cmbfac = document.getElementById('cmbFacultad').selectedIndex;
	//alert (idsolicitud);
	//alert (cmbfac);
	var cmbdirig = document.getElementById('cmbDirigido').selectedIndex;
	var tipoSol = document.getElementById('cmbTipoSolicitud').selectedIndex;
	var detalle = document.getElementById('txtSolicitud').value;
	
	if (detalle == null || detalle.length == 0)
	{
		alert("campo detalle de la solicitud se encuentra vacío");
		return false;
	}
	return true;
}

function LimpiarCampos()
{
	//document.getElementById('txtIdSolicitud').value='';
	document.getElementById('cmbFacultad').selectedIndex=0;
	document.getElementById('cmbDirigido').selectedIndex=0;
	document.getElementById('cmbTipoSolicitud').selectedIndex=0;
	document.getElementById('txtSolicitud').value='';
}

function RegistrarSolicitud(){
if(ValidaCampos()){	
	var url = "http://www.compuserviceteleco.com/guardar.php";
	var strParams = $("#frmIngreso").serialize();
	//alert(strParams)
	
	$.post(url, strParams, function(data){
		//alert(data)
		arr = data.split("|"); 
		if(arr[0] == "OK"){
			alert(arr[1]);
			//alert("Grabado con exito");
		}else if(arr[0] == "NO"){
		
		}else{
		}
	});
	
	LimpiarCampos();
}
}

function Regresar(){
	window.location.href = "contenido.html?usuario=" + strUsuario;
}


function CerrarSesion(){
	window.location.href = "index.html";
}

function CargarCmbFacultad(){	
			//dataPost = [];
			
			$.ajax({
				url: "http://www.compuserviceteleco.com/combo_facultad.php",
				type: "post",
				/*data: dataPost,*/
				success: function (data) {
					//alert(data)
					$("#dvFacultad").html(data);
					
				},error: function (jqXHR, ajaxOptions, thrownError) {
					//callback(formatErrorMessage(jqXHR, ajaxOptions));
					alert(formatErrorMessage(jqXHR, ajaxOptions));
					
				}
			});
		}

		
function CargarCmbTipo(){	
			//dataPost = [];
			
			$.ajax({
				url: "http://www.compuserviceteleco.com/combo_tipo.php",
				type: "post",
				/*data: dataPost,*/
				success: function (data) {
					//alert(data)
					$("#dvTipo").html(data);
					
				},error: function (jqXHR, ajaxOptions, thrownError) {
					//callback(formatErrorMessage(jqXHR, ajaxOptions));
					alert(formatErrorMessage(jqXHR, ajaxOptions));
					
				}
			});
		}


		
CargarCmbFacultad();		
CargarCmbTipo();
</script>
</html>